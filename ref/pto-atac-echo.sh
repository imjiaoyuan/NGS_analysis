while read line
do
        arr=($line)
        fq1=${arr[0]}
        fq2=${arr[1]}
        sample=${arr[2]}
        echo " fastp --in1 $fq1  --in2 $fq2  --out1 ./${sample}.clean_read1.fq.gz --out2  ${sample}.clean_read2.fq.gz  --cut_tail  --cut_tail_window_size=1 --cut_tail_mean_quality=30 --average_qual=30  --length_required=20 --html ./${sample}.html  --json ${sample}.json  &&  bwa mem -t 20  -M -k 17   /mnt/may1nov1/u5011/genome/pto_hap1/pto_A/bwa_index/pto_1_ref   ./${sample}.clean_read1.fq.gz    ${sample}.clean_read2.fq.gz   | samtools sort -@ 8 -o ./${sample}.bam - &&  samtools flagstat  ./${sample}.bam  >./${sample}.bam.flagstat  &&  samtools  view  -h  ./${sample}.bam | grep -v -e \"MW376760.1\" -e \"MZ675536.1\" | samtools view -o ./${sample}.uniq.bam  && samtools rmdup ./${sample}.uniq.bam  ./${sample}.last.bam && samtools view -b -q 30 -f 2 ./${sample}.last.bam >./${sample}.q30.bam  && samtools index  ./${sample}.q30.bam &&samtools flagstat ./${sample}.q30.bam > ./${sample}.q30.flagstat  &&    bamCoverage --bam ./${sample}.q30.bam -o ./${sample}.q30.bw  --binSize 10 --effectiveGenomeSize  352383277  --normalizeUsing RPKM  --smoothLength 50  &&  macs2 callpeak  -g 352383277  -t  ${sample}.q30.bam  -f  BAMPE --nomodel --extsize 200 --shift -100 --pvalue 0.05   -B  -n  ${sample}-ATAC && picard MarkDuplicates  I=./${sample}.uniq.bam   O=./${sample}.picard.bam  M=./${sample}.picard_marked_dup_metrics.txt REMOVE_DUPLICATES=true  && samtools view -b -q 30 -f 2 ./${sample}.picard.bam >./${sample}.picard.q30.bam && samtools index ./${sample}.picard.q30.bam && samtools flagstat ./${sample}.picard.q30.bam > ./${sample}.picard.q30.flagstat  &&   bamCoverage --bam ./${sample}.picard.q30.bam -o ./${sample}.picard.q30.bw  --binSize 10 --effectiveGenomeSize  352383277  --normalizeUsing RPKM  --smoothLength 50 && macs2 callpeak  -g 352383277  -t  ${sample}.picard.q30.bam  -f  BAMPE --nomodel --extsize 200 --shift -100 --pvalue 0.05   -B  -n  ${sample}-ATAC-picard-q30"   >> pto-atac.sh
done
